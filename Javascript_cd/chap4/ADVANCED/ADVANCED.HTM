<HTML>
<HEAD>
<TITLE>Advanced Scrolling</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFFF" onLoad="startscrl()">

 
<SCRIPT LANGUAGE="JavaScript1.1"> 
<!-- start javascript --- 
 
/*
   Feel free to use this script in your own page, making changes were
   necessary, but do leave the following line in the code.  Thanks

   Copyright 1996, E.T. Smith Associates Brogue, Pennsylvania, USA 

   Special thanks to Andy Augustine for helping me rewrite the 
   script to be more readable and object oriented. Check out
   http://www.freqgrafx.com/411/ for javascript info and codes.
*/ 
 function scrl_param(){
   this.bgn_ln = "About to start to scroll";
   this.txt_ln = "Scrolling Text Box...  "
              + "A number of features...  "
              + "simple set up...   " 
              + "user stop/restart...   " 
              + "place anywhere on page...   "
              + "set length of box...   " 
              + "any number of scroll iterations...   "; 
   this.end_ln = "All Done Scrolling";

   this.speed = 100; 
   this.box_lg = 70;
   this.max = 10;
   this.count = 0;
   this.pos = 0;  
   this.stop = 0;
   this.box_ln = " ";
   if( this.txt_ln.length < this.box_lg ){  
      this.msg_ln = this.txt_ln; 
      for( var i = 0 ; i < (this.box_lg - this.txt_ln.length) ; i++ ) 
         this.msg_ln += " "; 
    }   
   else{ 
     this.msg_ln = this.txt_ln; 
     this.msg_ln += "          ";
   }  

  }

 var scrl = new scrl_param();
     
 function scrlbox() 
   { 
    /* if whole has been scrolled, reset to beginning of line */
    if( scrl.pos > scrl.msg_ln.length ){
      scrl.pos = 1;  
      scrl.count++; 
     } 
    
   /* construct display line using the line position property */
   scrl.box_ln = " "; 
   scrl.box_ln += scrl.msg_ln.substring(scrl.pos,scrl.msg_ln.length);  
   scrl.box_ln += scrl.msg_ln.substring(0,scrl.pos);  
 
   /* continue, if user hasn't unfocused the box */
   if( scrl.stop == 0 ) 
     {   
      /* The following sets focus on the scroll box, allowing the user to
         easy stop the text by clicking out of the box.  If scroll is to
         be located such that when the page is loaded the box may not be
         seen, the user may inadvertantly stop the text by clicking on
         the page before seeing the box. For this case you may wish to
         comment out the following line. The user will then have to click
         in the box and then out of the box to stop the text.
       */  
      document.scrlform.scrlbox.focus(); 

      /* continue if the maximum iterations have not been done */ 
      if( scrl.count < scrl.max ) 
        { 
         scrl.pos++; /* advance line postion for next iteration */
         document.scrlform.scrlbox.value = scrl.box_ln; /* display new line */
         time3 = window.setTimeout('scrlbox()',scrl.speed); /* restart function */
        } 
      else /* maximum iteration been done */ 
        { 
         if ( scrl.end_ln.length > 2 ){ /* display end message if any */
            time2 = window.setTimeout("document.scrlform.scrlbox.value ="+ 'scrl.end_ln',scrl.speed); 
           } 
         document.scrlform.scrlbox.blur(); /* remove focus, so user */
        }                                  /* can easily restart */ 
     } 
  } 
 /* restart function */
 function startscrl() 
  { 
   scrl.stop = 0; 
   scrl.pos = 0; 
   scrlbox(); 
  } 
 
/* stop function */ 
function stopscrl() 
 { 
  scrl.stop = 1; 
 } 
 
// --- end javascript --> 
</SCRIPT> 
 
<SCRIPT LANGUAGE="JavaScript1.1"> 
<!-- start javascript --- 
document.write("<DIV ALIGN=CENTER><FORM NAME='scrlform'>"); 
document.write("<INPUT NAME='scrlbox' SIZE=" + scrl.box_lg + " onFocus='startscrl();' onBlur='stopscrl();' VALUE='" + scrl.bgn_ln + "'><BR>"); 
document.write("<SMALL><EM>To stop scrolling, select anywhere on page except the scrolling text field. "); 
document.write("To restart scrolling text, select the text field<BR></EM>"); 
time1 = window.setTimeout('scrlbox()',2000); 
document.write("<P></FORM></DIV>"); 
// --- end javascript --> 
</SCRIPT> 



</body>
</HTML>
