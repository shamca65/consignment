<server>
/*
** page that is shown when there is a database error
**
** Parameters:
**   None
**
** Globals:
**   client.app_err - error message generated by the calling function
**
** Locals:
**   msg - message to display in alert box
**
*/
</server>

<html>
<head>
<title>Application Error</title>
</head>
<body bgcolor="#ffffff">

<server>
// set the error message
var msg = "Your request could not be processed because " +
          " an application error occurred.\\n\\n";

if (client.app_err && client.app_err != "null")
{
   msg += replaceChar (client.app_err, "\n", "\\n");
}

msg += " Please contact the administrator for assistance.";

// clear the error specific message
client.app_err = null;

// escape any odd characters in the message
msg = replaceChar (msg, "'", "''");

// show the message in an alert box
writeln ('<script>');
writeln ('   alert ("' + msg + '")');
writeln ('</script>');
dbRelease ();
</server>

</body>
</html>
