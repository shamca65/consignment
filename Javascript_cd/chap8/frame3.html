<html>
<head>
<title></title>
</head>

<server>
function copyContact (obj)
{
   this.id         = (isNum (obj.id) ? obj.id         + "" : "0")
   this.fname      = (obj.fname      ? obj.fname      + "" : "");
   this.lname      = (obj.lname      ? obj.lname      + "" : "");
   this.street     = (obj.street     ? obj.street     + "" : "");
   this.city       = (obj.city       ? obj.city       + "" : "");
   this.state      = (obj.state      ? obj.state      + "" : "");
   this.zipcode    = (obj.zipcode    ? obj.zipcode    + "" : "");
   this.homephone  = (obj.homephone  ? obj.homephone  + "" : "");
   this.workphone  = (obj.workphone  ? obj.workphone  + "" : "");
   this.notes      = (obj.notes      ? obj.notes      + "" : "");
   this.lastupdate = (obj.lastupdate ? obj.lastupdate + "" : "");

   return (this);
}
</server>

<body bgcolor="#ffffff">

<server>
var sql = "select * from contact where id='" + request.id + "'";
var cursor = database.cursor (sql);
cursor.next ();
var contact = new copyContact (cursor);
cursor.close ();

for (var i in contact)
{
   contact[i] = trim (contact[i]);
}
</server>

<form name="form" action="contact.html">

<input type="hidden" name="id" value=`contact.id`>
<input type="hidden" name="op" value="">

<center>
<table border=1>

<tr>
   <td>First Name:</td>
   <td>
      <input type="text" name="fname" value=`contact.fname`
             size=20 maxlength=20>
   </td>
</tr>

<tr>
   <td>Last Name:</td>
   <td>
      <input type="text" name="lname" value=`contact.lname`
             size=20 maxlength=20>
   </td>
</tr>

<tr>
   <td>Street:</td>
   <td>
      <input type="text" name="street" value=`contact.street`
             size=40 maxlength=80>
   </td>
</tr>

<tr>
   <td>City:</td>
   <td>
      <input type="text" name="city" value=`contact.city`
             size=40 maxlength=40>
   </td>
</tr>

<tr>
   <td>State:</td>
   <td>
      <server>
         sql = "select code, value from lookup where type='STATE'";
         dbShowSelect ("state", contact.state, sql);
      </server>
   </td>
</tr>

<tr>
   <td>Zipcode:</td>
   <td>
      <input type="text" name="zipcode" value=`contact.zipcode`
             size=10 maxlength=10>
   </td>
</tr>

<tr>
   <td>Home Phone:</td>
   <td>
      <input type="text" name="homephone" value=`contact.homephone`
             size=20 maxlength=20>
   </td>
</tr>

<tr>
   <td>Work Phone:</td>
   <td>
      <input type="text" name="workphone" value=`contact.workphone`
             size=20 maxlength=20>
   </td>
</tr>

<tr>
   <td>Notes:</td>
   <td>
      <input type="text" name="notes" value=`contact.notes` size=40 maxlength=2048>
   </td>
</tr>

<tr>
   <td>Last Update:</td>
   <td>
   <server>
      // var lastupdate = timeStampToDate (contact.lastupdate);
      writeln (contact.lastupdate);
   </server>
   </td>
</tr>

</table>
</center>

</form>

</body>
</html>
