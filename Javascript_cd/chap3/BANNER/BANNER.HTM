<HTML> 
<HEAD> 
<TITLE>Banner</TITLE> 
<SCRIPT LANGUAGE="JavaScript"> 

<!-- 

var speed = 100 

var pause = 1000

var timerID = null 
var bannerRunning = false 

var ar = new Array() 

ar[0] = "Welcome to our JavaScript book" 
ar[1] = "The Banner script works in the status bar area" 
ar[2] = "It is a very stable banner" 
ar[3] = "It is only one of many such examples" 

var currentMessage = 0 

var offset = 0 

function stopBanner() { 
        if (bannerRunning) 
                clearTimeout(timerID) 

        bannerRunning = false 
} 

function startBanner() { 
        stopBanner() 

        showBanner() 
} 

function showBanner() { 
        var text = ar[currentMessage] 

        if (offset < text.length) { 
                if (text.charAt(offset) == " ") 
                        offset++                         

                var partialMessage = text.substring(0, offset + 1)  

                window.status = partialMessage 

                offset++ // IE sometimes has trouble with "++offset" 

                timerID = setTimeout("showBanner()", speed) 

                bannerRunning = true 
        } else { 
                offset = 0 

                currentMessage++ 

                if (currentMessage == ar.length) 
                        currentMessage = 0 

                timerID = setTimeout("showBanner()", pause) 

                bannerRunning = true 
        } 
} 

// --> 

</SCRIPT> 
</HEAD> 
<BODY onLoad="startBanner()"> 
</BODY> 
</HTML> 
